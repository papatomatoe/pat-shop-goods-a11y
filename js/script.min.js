"use strict";const SelectActions={Close:0,CloseSelect:1,First:2,Last:3,Next:4,Open:5,PageDown:6,PageUp:7,Previous:8,Select:9,Type:10};function filterOptions(a=[],b,c=[]){return a.filter(a=>{let d=0===a.title.toLowerCase().indexOf(b.toLowerCase());return d&&0>c.indexOf(a)})}function getActionFromKey(d,c){let{key:a,altKey:b,ctrlKey:e,metaKey:f}=d;if(!c&&["ArrowDown","ArrowUp","Enter"," "].includes(a))return SelectActions.Open;if("Home"===a)return SelectActions.First;if("End"===a)return SelectActions.Last;if("Backspace"===a||"Clear"===a||1===a.length&&" "!==a&&!b&&!e&&!f)return SelectActions.Type;if(c){if("ArrowUp"===a&&b)return SelectActions.CloseSelect;if("ArrowDown"===a&&!b)return SelectActions.Next;if("ArrowUp"===a)return SelectActions.Previous;if("PageUp"===a)return SelectActions.PageUp;else if("PageDown"===a)return SelectActions.PageDown;else if("Escape"===a)return SelectActions.Close;else if("Enter"===a||" "===a)return SelectActions.CloseSelect}}function getIndexByLetter(a,b,c=0){var f;let d=[...a.slice(c),...a.slice(0,c),],e=filterOptions(d,b)[0];if(e)return a.indexOf(e);if(!(f=b.split("")).every(a=>a===f[0]))return -1;{let g=filterOptions(d,b[0]);return a.indexOf(g[0])}}function getUpdatedIndex(a,b,c){switch(c){case SelectActions.First:return 0;case SelectActions.Last:return b;case SelectActions.Previous:return Math.max(0,a-1);case SelectActions.Next:return Math.min(b,a+1);case SelectActions.PageUp:return Math.max(0,a-10);case SelectActions.PageDown:return Math.min(b,a+10);default:return a}}function isElementInView(b){var a=b.getBoundingClientRect();return a.top>=0&&a.left>=0&&a.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&a.right<=(window.innerWidth||document.documentElement.clientWidth)}function isScrollable(a){return a&&a.clientHeight<a.scrollHeight}function maintainScrollVisibility(f,b){let{offsetHeight:c,offsetTop:a}=f,{offsetHeight:d,scrollTop:e}=b;a<e?b.scrollTo(0,a):a+c>e+d&&b.scrollTo(0,a-d+c)}const Select=function(a,b=[]){this.el=a,this.comboEl=a.querySelector("[role=combobox]"),this.listboxEl=a.querySelector("[role=listbox]"),this.itemList=document.querySelector(".goods__list"),this.items=this.itemList.querySelectorAll(".goods__item"),this.idBase=this.comboEl.id||"combo",this.options=b,this.activeIndex=0,this.open=!1,this.searchString="",this.searchTimeout=null,a&&this.comboEl&&this.listboxEl&&this.init()};Select.prototype.init=function(){this.comboEl.innerHTML=this.options[0].title,this.comboEl.addEventListener("blur",this.onComboBlur.bind(this)),this.comboEl.addEventListener("click",this.onComboClick.bind(this)),this.comboEl.addEventListener("keydown",this.onComboKeyDown.bind(this)),this.options.map((a,b)=>{let c=this.createOption(a.title,b);this.listboxEl.appendChild(c)})},Select.prototype.createOption=function(c,b){let a=document.createElement("div");return a.setAttribute("role","option"),a.id=`${this.idBase}-${b}`,a.className=0===b?"combo-option option-current":"combo-option",a.setAttribute("aria-selected",`${0===b}`),a.innerText=c,a.addEventListener("click",a=>{a.stopPropagation(),this.onOptionClick(b)}),a.addEventListener("mousedown",this.onOptionMouseDown.bind(this)),a},Select.prototype.getSearchString=function(a){return"number"==typeof this.searchTimeout&&window.clearTimeout(this.searchTimeout),this.searchTimeout=window.setTimeout(()=>{this.searchString=""},500),this.searchString+=a,this.searchString},Select.prototype.onComboBlur=function(){if(this.ignoreBlur){this.ignoreBlur=!1;return}this.open&&(this.selectOption(this.activeIndex),this.updateMenuState(!1,!1))},Select.prototype.onComboClick=function(){this.updateMenuState(!this.open,!1)},Select.prototype.onComboKeyDown=function(a){let{key:c}=a,d=this.options.length-1,b=getActionFromKey(a,this.open);switch(b){case SelectActions.Last:case SelectActions.First:this.updateMenuState(!0);case SelectActions.Next:case SelectActions.Previous:case SelectActions.PageUp:case SelectActions.PageDown:return a.preventDefault(),this.onOptionChange(getUpdatedIndex(this.activeIndex,d,b));case SelectActions.CloseSelect:a.preventDefault(),this.selectOption(this.activeIndex);case SelectActions.Close:return a.preventDefault(),this.updateMenuState(!1);case SelectActions.Type:return this.onComboType(c);case SelectActions.Open:return a.preventDefault(),this.updateMenuState(!0)}},Select.prototype.onComboType=function(b){this.updateMenuState(!0);let c=this.getSearchString(b),a=getIndexByLetter(this.options,c,this.activeIndex+1);a>=0?this.onOptionChange(a):(window.clearTimeout(this.searchTimeout),this.searchString="")},Select.prototype.onOptionChange=function(a){this.activeIndex=a,this.comboEl.setAttribute("aria-activedescendant",`${this.idBase}-${a}`);let b=this.el.querySelectorAll("[role=option]");[...b].forEach(a=>{a.classList.remove("option-current")}),b[a].classList.add("option-current"),isScrollable(this.listboxEl)&&maintainScrollVisibility(b[a],this.listboxEl),isElementInView(b[a])||b[a].scrollIntoView({behavior:"smooth",block:"nearest"})},Select.prototype.onOptionClick=function(a){this.onOptionChange(a),this.selectOption(a),this.updateMenuState(!1)},Select.prototype.onOptionMouseDown=function(){this.ignoreBlur=!0},Select.prototype.selectOption=function(a){this.activeIndex=a;let c=this.options[a];this.comboEl.innerHTML=c.title;let b=this.el.querySelectorAll("[role=option]");[...b].forEach(a=>{a.setAttribute("aria-selected","false")}),b[a].setAttribute("aria-selected","true");let e=this.options[this.activeIndex].value,d=[...this.items].sort((a,b)=>{let f=a.querySelector(".js-price")??a.querySelector(".goods__price"),c=Number(f.innerText.split("$")[0]),g=b.querySelector(".js-price")??b.querySelector(".goods__price"),d=Number(g.innerText.split("$")[0]);return e?"increase"===e?c-d:d-c:0});[...this.itemList.children].forEach(a=>this.itemList.removeChild(a)),d.forEach(a=>this.itemList.append(a))},Select.prototype.updateMenuState=function(a,c=!0){if(this.open===a)return;this.open=a,this.comboEl.setAttribute("aria-expanded",`${a}`),a?this.el.classList.add("open"):this.el.classList.remove("open");let b=a?`${this.idBase}-${this.activeIndex}`:"";this.comboEl.setAttribute("aria-activedescendant",b),""!==b||isElementInView(this.comboEl)||this.comboEl.scrollIntoView({behavior:"smooth",block:"nearest"}),c&&this.comboEl.focus()};class TabsManual{constructor(c){this.tablistNode=c,this.tabs=[],this.firstTab=null,this.lastTab=null,this.tabs=Array.from(this.tablistNode.querySelectorAll("[role=tab]")),this.tabpanels=[];for(var b=0;b<this.tabs.length;b+=1){var a=this.tabs[b],d=document.getElementById(a.getAttribute("aria-controls"));a.tabIndex=-1,a.setAttribute("aria-selected","false"),this.tabpanels.push(d),a.addEventListener("keydown",this.onKeydown.bind(this)),a.addEventListener("click",this.onClick.bind(this)),this.firstTab||(this.firstTab=a),this.lastTab=a}this.setSelectedTab(this.firstTab)}setSelectedTab(c){for(var a=0;a<this.tabs.length;a+=1){var b=this.tabs[a];c===b?(b.setAttribute("aria-selected","true"),b.removeAttribute("tabindex"),this.tabpanels[a].classList.remove("is-hidden")):(b.setAttribute("aria-selected","false"),b.tabIndex=-1,this.tabpanels[a].classList.add("is-hidden"))}}moveFocusToTab(a){a.focus()}moveFocusToPreviousTab(a){var b;a===this.firstTab?this.moveFocusToTab(this.lastTab):(b=this.tabs.indexOf(a),this.moveFocusToTab(this.tabs[b-1]))}moveFocusToNextTab(a){var b;a===this.lastTab?this.moveFocusToTab(this.firstTab):(b=this.tabs.indexOf(a),this.moveFocusToTab(this.tabs[b+1]))}onKeydown(b){var c=b.currentTarget,a=!1;switch(b.key){case"ArrowLeft":this.moveFocusToPreviousTab(c),a=!0;break;case"ArrowRight":this.moveFocusToNextTab(c),a=!0;break;case"Home":this.moveFocusToTab(this.firstTab),a=!0;break;case"End":this.moveFocusToTab(this.lastTab),a=!0}a&&(b.stopPropagation(),b.preventDefault())}onClick(a){this.setSelectedTab(a.currentTarget)}}var aria=aria||{};aria.Utils=aria.Utils||{},aria.Utils.IgnoreUtilFocusChanges=!1,aria.Utils.dialogOpenClass="has-dialog",aria.Utils.focusFirstDescendant=function(b){for(var a=0;a<b.childNodes.length;a++){var c=b.childNodes[a];if(aria.Utils.attemptFocus(c)||aria.Utils.focusFirstDescendant(c))return!0}return!1},aria.Utils.focusLastDescendant=function(b){for(var a=b.childNodes.length-1;a>=0;a--){var c=b.childNodes[a];if(aria.Utils.attemptFocus(c)||aria.Utils.focusLastDescendant(c))return!0}return!1},aria.Utils.attemptFocus=function(a){if(!aria.Utils.isFocusable(a))return!1;aria.Utils.IgnoreUtilFocusChanges=!0;try{a.focus()}catch(b){}return aria.Utils.IgnoreUtilFocusChanges=!1,document.activeElement===a},aria.OpenDialogList=aria.OpenDialogList||new Array(0),aria.getCurrentDialog=function(){if(aria.OpenDialogList&&aria.OpenDialogList.length)return aria.OpenDialogList[aria.OpenDialogList.length-1]},aria.closeCurrentDialog=function(){var a=aria.getCurrentDialog();return!!a&&(a.close(),!0)},aria.handleEscape=function(a){(a.which||a.keyCode)===aria.KeyCode.ESC&&aria.closeCurrentDialog()&&a.stopPropagation()},document.addEventListener("keyup",aria.handleEscape),aria.Dialog=function(c,a,b){if(this.dialogNode=document.getElementById(c),null===this.dialogNode)throw new Error('No element found with id="'+c+'".');var g=["dialog","alertdialog"];if(!(this.dialogNode.getAttribute("role")||"").trim().split(/\s+/g).some(function(a){return g.some(function(b){return a===b})}))throw new Error("Dialog() requires a DOM element with ARIA role of dialog or alertdialog.");var d="dialog-backdrop";if(this.dialogNode.parentNode.classList.contains(d)?this.backdropNode=this.dialogNode.parentNode:(this.backdropNode=document.createElement("div"),this.backdropNode.className=d,this.dialogNode.parentNode.insertBefore(this.backdropNode,this.dialogNode),this.backdropNode.appendChild(this.dialogNode)),this.backdropNode.classList.add("active"),document.body.classList.add(aria.Utils.dialogOpenClass),"string"==typeof a)this.focusAfterClosed=document.getElementById(a);else if("object"==typeof a)this.focusAfterClosed=a;else throw new Error("the focusAfterClosed parameter is required for the aria.Dialog constructor.");"string"==typeof b?this.focusFirst=document.getElementById(b):"object"==typeof b?this.focusFirst=b:this.focusFirst=null;var e=document.createElement("div");this.preNode=this.dialogNode.parentNode.insertBefore(e,this.dialogNode),this.preNode.tabIndex=0;var f=document.createElement("div");this.postNode=this.dialogNode.parentNode.insertBefore(f,this.dialogNode.nextSibling),this.postNode.tabIndex=0,aria.OpenDialogList.length>0&&aria.getCurrentDialog().removeListeners(),this.addListeners(),aria.OpenDialogList.push(this),this.clearDialog(),this.dialogNode.className="default_dialog",this.focusFirst?this.focusFirst.focus():aria.Utils.focusFirstDescendant(this.dialogNode),this.lastFocus=document.activeElement},aria.Dialog.prototype.clearDialog=function(){Array.prototype.map.call(this.dialogNode.querySelectorAll("input"),function(a){a.value=""})},aria.Dialog.prototype.close=function(){aria.OpenDialogList.pop(),this.removeListeners(),aria.Utils.remove(this.preNode),aria.Utils.remove(this.postNode),this.dialogNode.className="hidden",this.backdropNode.classList.remove("active"),this.focusAfterClosed.focus(),aria.OpenDialogList.length>0?aria.getCurrentDialog().addListeners():document.body.classList.remove(aria.Utils.dialogOpenClass)},aria.Dialog.prototype.replace=function(a,b,c){aria.OpenDialogList.pop(),this.removeListeners(),aria.Utils.remove(this.preNode),aria.Utils.remove(this.postNode),this.dialogNode.className="hidden",this.backdropNode.classList.remove("active");var d=b||this.focusAfterClosed;new aria.Dialog(a,d,c)},aria.Dialog.prototype.addListeners=function(){document.addEventListener("focus",this.trapFocus,!0)},aria.Dialog.prototype.removeListeners=function(){document.removeEventListener("focus",this.trapFocus,!0)},aria.Dialog.prototype.trapFocus=function(b){if(!aria.Utils.IgnoreUtilFocusChanges){var a=aria.getCurrentDialog();a.dialogNode.contains(b.target)?a.lastFocus=b.target:(aria.Utils.focusFirstDescendant(a.dialogNode),a.lastFocus==document.activeElement&&aria.Utils.focusLastDescendant(a.dialogNode),a.lastFocus=document.activeElement)}},window.openDialog=function(a,b,c){new aria.Dialog(a,b,c)},window.closeDialog=function(b){var a=aria.getCurrentDialog();a.dialogNode.contains(b)&&a.close()},window.replaceDialog=function(b,c,d){var a=aria.getCurrentDialog();a.dialogNode.contains(document.activeElement)&&a.replace(b,c,d)};const form=document.querySelector(".dialog__form");form.addEventListener("submit",a=>{a.preventDefault(),window.replaceDialog("dialog2",void 0,"dialog2_close_btn")});var aria=aria||{};aria.KeyCode={BACKSPACE:8,TAB:9,RETURN:13,SHIFT:16,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46},aria.Utils=aria.Utils||{},aria.Utils.matches=function(a,b){return Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(d){for(var c=a.parentNode.querySelectorAll(d),b=c.length;--b>=0&&c.item(b)!==this;);return b> -1}),a.matches(b)},aria.Utils.remove=function(a){return a.remove&&"function"==typeof a.remove?a.remove():!!a.parentNode&&!!a.parentNode.removeChild&&"function"==typeof a.parentNode.removeChild&&a.parentNode.removeChild(a)},aria.Utils.isFocusable=function(a){if(a.tabIndex<0||a.disabled)return!1;switch(a.nodeName){case"A":return!!a.href&&"ignore"!=a.rel;case"INPUT":return"hidden"!=a.type;case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}},aria.Utils.getAncestorBySelector=function(b,d){if(!aria.Utils.matches(b,d+" "+b.tagName))return null;for(var a=b,c=null;null===c;)aria.Utils.matches(a.parentNode,d)?c=a.parentNode:a=a.parentNode;return c},aria.Utils.hasClass=function(a,b){return new RegExp("(\\s|^)"+b+"(\\s|$)").test(a.className)},aria.Utils.addClass=function(a,b){aria.Utils.hasClass(a,b)||(a.className+=" "+b)},aria.Utils.removeClass=function(a,b){var c=new RegExp("(\\s|^)"+b+"(\\s|$)");a.className=a.className.replace(c," ").trim()},aria.Utils.bindMethods=function(b){var a=Array.prototype.slice.call(arguments,1);a.forEach(function(a){b[a]=b[a].bind(b)})};class RadioGroup{constructor(d){this.groupNode=d,this.radioButtons=[],this.firstRadioButton=null,this.lastRadioButton=null;for(var c=this.groupNode.querySelectorAll("[role=radio]"),b=0;b<c.length;b+=1){var a=c[b];0===b?(a.tabIndex=0,a.setAttribute("aria-checked","true")):(a.tabIndex=-1,a.setAttribute("aria-checked","false")),a.addEventListener("keydown",this.handleKeydown.bind(this)),a.addEventListener("click",this.handleClick.bind(this)),a.addEventListener("focus",this.handleFocus.bind(this)),a.addEventListener("blur",this.handleBlur.bind(this)),this.radioButtons.push(a),this.firstRadioButton||(this.firstRadioButton=a),this.lastRadioButton=a}this.firstRadioButton.tabIndex=0}setChecked(a){for(var b=0;b<this.radioButtons.length;b+=1){var c=this.radioButtons[b];c.setAttribute("aria-checked","false"),c.tabIndex=-1}a.setAttribute("aria-checked","true"),a.tabIndex=0,a.focus()}setCheckedToPreviousItem(a){var b;a===this.firstRadioButton?this.setChecked(this.lastRadioButton):(b=this.radioButtons.indexOf(a),this.setChecked(this.radioButtons[b-1]))}setCheckedToNextItem(a){var b;a===this.lastRadioButton?this.setChecked(this.firstRadioButton):(b=this.radioButtons.indexOf(a),this.setChecked(this.radioButtons[b+1]))}handleKeydown(a){var c=a.currentTarget,b=!1;switch(a.key){case" ":case"Enter":this.setChecked(c),b=!0;break;case"Up":case"ArrowUp":case"Left":case"ArrowLeft":this.setCheckedToPreviousItem(c),b=!0;break;case"Down":case"ArrowDown":case"Right":case"ArrowRight":this.setCheckedToNextItem(c),b=!0}b&&(a.stopPropagation(),a.preventDefault())}handleClick(a){this.setChecked(a.currentTarget)}handleFocus(a){a.currentTarget.classList.add("focus")}handleBlur(a){a.currentTarget.classList.remove("focus")}}window.addEventListener("load",function(){for(var b=document.querySelectorAll('[role="radiogroup"]'),a=0;a<b.length;a+=1)new RadioGroup(b[a]);let f=[{title:"\u041D\u0435\u0442 \u0441\u043E\u0440\u0442\u0438\u0440\u043E\u0432\u043A\u0438",value:null},{title:"\u041F\u043E \u0432\u043E\u0437\u0440\u0430\u0441\u0442\u0430\u043D\u0438\u044E \u0446\u0435\u043D\u044B",value:"increase"},{title:"\u041F\u043E \u0443\u0431\u044B\u0432\u0430\u043D\u0438\u044E \u0446\u0435\u043D\u044B",value:"decrease"},],e=document.querySelectorAll(".js-select");e.forEach(a=>{new Select(a,f)});for(var c=document.querySelectorAll("[role=tablist].manual"),a=0;a<c.length;a++)new TabsManual(c[a]);let d=document.querySelector(".subscribe__form"),g=d.querySelector(".js-subscribe-btn");d.addEventListener("submit",a=>{a.preventDefault(),openDialog("dialog3",g)})})
